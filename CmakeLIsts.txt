cmake_minimum_required(VERSION 3.10)
set(GAME_NAME RestTrolley)
project(${GAME_NAME} VERSION 1.0)

# 找到所有 SDL3 相关库
find_package(SDL3 REQUIRED CONFIG REQUIRED COMPONENTS SDL3-shared)
find_package(SDL3_image REQUIRED CONFIG REQUIRED COMPONENTS SDL3_image-shared)
find_package(SDL3_mixer REQUIRED CONFIG REQUIRED COMPONENTS SDL3_mixer-shared)
find_package(SDL3_ttf REQUIRED CONFIG REQUIRED COMPONENTS SDL3_ttf-shared)
find_package(SDL3_net REQUIRED CONFIG REQUIRED COMPONENTS SDL3_net-shared)

# 添加可执行文件
add_executable(${GAME_NAME} code/main.cpp apps/icon.rc) # 增加控制台输出

# 统一链接 SDL3 库
target_link_libraries(${GAME_NAME} PRIVATE SDL3::SDL3 SDL3_image::SDL3_image SDL3_mixer::SDL3_mixer SDL3_ttf::SDL3_ttf SDL3_net::SDL3_net)

# 安装可执行文件到根目录
install(TARGETS ${GAME_NAME}
    RUNTIME DESTINATION bin
)

# 安装 DLL 到根目录
install(FILES
    $<TARGET_FILE:SDL3::SDL3>
    $<TARGET_FILE:SDL3_image::SDL3_image>
    $<TARGET_FILE:SDL3_mixer::SDL3_mixer>
    $<TARGET_FILE:SDL3_ttf::SDL3_ttf>
    $<TARGET_FILE:SDL3_net::SDL3_net>
    DESTINATION bin
)

# 安装资源文件夹到根目录
install(DIRECTORY ${CMAKE_SOURCE_DIR}/assets DESTINATION .)
# 下面这些主要用于mingw构建的游戏运行
set(MINGW_DLL_PATH "C:/Program Files (x86)/msys64/ucrt64/bin")

install(FILES
    "${MINGW_DLL_PATH}/libgcc_s_seh-1.dll"
    "${MINGW_DLL_PATH}/libstdc++-6.dll"
    DESTINATION bin
)